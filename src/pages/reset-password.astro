---
import AuthLayout from "@/layouts/AuthLayout.astro";
import ResetPasswordForm from "@/components/auth/ResetPasswordForm";

// Enable SSR for this page
export const prerender = false;

// Get token from URL query params
// Supabase can send either 'code' (PKCE flow) or 'access_token' (implicit flow)
const code = Astro.url.searchParams.get("code") || undefined;
const accessToken = Astro.url.searchParams.get("access_token") || undefined;
---

<AuthLayout title="Ustaw nowe hasło | Secret Santa">
  <ResetPasswordForm client:load code={code} accessToken={accessToken} />

  <div slot="footer-links">
    <p class="text-gray-600">
      Pamiętasz hasło?
      <a href="/login" class="text-red-500 hover:text-red-600 font-medium ml-1">Zaloguj się</a>
    </p>
  </div>
</AuthLayout>
